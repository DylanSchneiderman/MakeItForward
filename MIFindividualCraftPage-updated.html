<!DOCTYPE html>
<html>
<head>
	<title>Individual Craft Page</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel = "stylesheet" href="MIF.css">
	<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.6.3/css/all.css' integrity='sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/' crossorigin='anonymous'>
	<link href="https://fonts.googleapis.com/css?family=Frank+Ruhl+Libre|Secular+One" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Tinos" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/5.7.3/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBj34sidpPNHaIu-VTZnuiiJ0dtSwSvnh8",
    authDomain: "makeitforward-fb720.firebaseapp.com",
    databaseURL: "https://makeitforward-fb720.firebaseio.com",
    projectId: "makeitforward-fb720",
    storageBucket: "makeitforward-fb720.appspot.com",
    messagingSenderId: "668998987480"
  };
  firebase.initializeApp(config);
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body onload="grabSteps()">


	<div id="craftTitle">
		שולחן עבודה מעץ
	</div>
	<div id="FinalImage">
		

	</div>
	

	
	<div id="crafterDiv">
		<span id = "crafterName">גפן גלדסטון</span>
		<i id = "userIcon" class='fas fa-user-circle'></i>
	</div>

	<div id="craftDescription">
		זהו שולחן עץ חסון מושלם להכנת כל מיני פרויקטים חדשים
	</div>


	<div id="materialsDiv">
		<h3 id="materialsTitle">חומרים</h3>
		<ul id = "materialsList">
			
		</ul>
	</div>
	

	<div id = "stepsList">
		
		
	</div>

	<script>
		let extractGetParameter = function(key) {
        	let a = new URLSearchParams(window.location.search);
        	return a.get(key);
   		 };
   		var steps=[];

   		//Gets all the steps into a snapshot aand stores them for later use
   		function grabSteps(){
		let db = firebase.database();
		let dbref = db.ref("Users/USERID/");
			dbref.once("value", function(snapshot){
				$(".stepsImagesOutline").html("");
				$("#FinalImage").html("");
				console.log(snapshot.val());
				snapshot.forEach(function(snap){
					console.log(snap.val());
					steps.push(snap.val());
					addImageStep();

				});
			});
   		}
   			


		STEPNUM = 1;	
	   	function addImageStep(){
	   		var IMAGE_URL;
	   		var STEP_TEXT;
	   		let FinalImage = steps[0].METADATA.FinishImage;

	   		const FinalImageTemplate = '<img class = "finalProjectImages" src = "'+FinalImage+'">';
	   		$("#FinalImage").append(FinalImageTemplate);


	   		for (var i = 0; i < steps[0].METADATA.stepNum; i++) {
	   			var stepMarker = 'Step'+(i+1);
	   			IMAGE_URL = steps[0].STEP_IMAGES[stepMarker]; 
	   			STEP_TEXT = steps[0].STEPS[stepMarker];
	   			console.log(IMAGE_URL);
	   			const StepTemplate = '<div class = "stepsImagesOutline"><img class = "projectImages" src = "'+IMAGE_URL+'"><div class="stepNumber">שלב '+(i+1)+'</div><div class="instruction">'+STEP_TEXT+'</div></div>';
	   			$("#stepsList").append(StepTemplate);
	   			STEPNUM++;
	   		}

	   		$("#stepsList").each(function(index){
	   			console.log($(this).text());
	   		});

	   		for(var i=0; i<steps[0].METADATA.toolNum; i++){
	   			var toolMarker= "Tool"+(i+1);
	   			var tool = steps[0].TOOLS[toolMarker];
	   			$("#materialsList").append("<li>"+tool+"</li>");
	   		}



	   		
	   		
	   		

	   		
	   		
	   		
	   	}

	</script>



</body>
</html>